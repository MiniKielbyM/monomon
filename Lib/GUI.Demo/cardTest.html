<!DOCTYPE html>
<html>

<head>
    <title>Board Layout</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="BoardLayout.css">
</head>

<body>
    <div id="aspect-box">
        <div id="sixteenbynine">

            <div id="opponent-zone">
                <div class="bench">
                    <div class="card benched opp empty"></div>
                    <div class="card benched opp empty"></div>
                    <div class="card benched opp empty"></div>
                    <div class="card benched opp empty"></div>
                    <div class="card benched opp empty"></div>
                </div>
                <div class="card active opp empty"></div>
                <div class="card lost-zone opp empty"></div>
                <div class="card discard opp empty"></div>
                <div class="deck opp"></div>
                <div class="prize-zone one">
                    <div class="card opp prize faceDown"></div>
                    <div class="card opp prize faceDown"></div>
                </div>
                <div class="prize-zone two">
                    <div class="card opp prize faceDown"></div>
                    <div class="card opp prize faceDown"></div>
                </div>
                <div class="prize-zone three">
                    <div class="card opp prize faceDown"></div>
                    <div class="card opp prize faceDown"></div>
                </div>
            </div>
            <div id="player-zone">
                <div id="ActivePokemon" class="card active player empty"></div>
                <div class="bench">
                    <div class="card player benched empty"></div>
                    <div class="card player benched empty"></div>
                    <div class="card player benched empty"></div>
                    <div class="card player benched empty"></div>
                    <div class="card player benched empty"></div>
                </div>
                <div class="hand-outer">
                    <div class="hand-inner">
                        <div id="PlayerHand" class="hand">

                        </div>
                    </div>
                </div>
                <div class="prize-zone one">
                    <div class="card player prize faceDown"></div>
                    <div class="card player prize faceDown"></div>
                </div>
                <div class="prize-zone two">
                    <div class="card player prize faceDown"></div>
                    <div class="card player prize faceDown"></div>
                </div>
                <div class="prize-zone three">
                    <div class="card player prize faceDown"></div>
                    <div class="card player prize faceDown"></div>
                </div>
                <div class="deck player"></div>
                <div class="card discard player empty"></div>
                <div class="card lost-zone player empty"></div>
            </div>

        </div>
    </div>
    <script type="module">
        import Client from '../client.js';
        import Game from '../game.js';
        import Deck from '../deck.js';
        import Pikachu from '../cardTest.js';
        import GUIHookUtils from '../guiHookUtils.js';
        import enums from '../enums.js';
        import { Card } from '../card.js';
        import BaseCards from '../Cards/Base/Base1/Cards.js';

        const { PokemonType, CardModifiers } = enums;
        const { Alakazam, Blastoise } = BaseCards;

        // Initialize GUI Hook
        const guiHook = new GUIHookUtils();

        // Create players with decks
        const player1Deck = new Deck('Player 1 Test Deck');
        const player2Deck = new Deck('Player 2 Test Deck');

        const player1 = new Client('Player 1', player1Deck);
        const player2 = new Client('Player 2', player2Deck);

        // Create the game
        const game = new Game(player1, player2, guiHook);

        // Create test cards for both players using Cards.js
        const p1Cards = [
            new Pikachu(player1),
            new Alakazam(player1),
            new Blastoise(player1),
            new Pikachu(player1),
            new Blastoise(player1),
            new Pikachu(player1)
        ];

        const p2Cards = [
            new Blastoise(player2),
            new Pikachu(player2),
            new Alakazam(player2),
            new Blastoise(player2)
        ];

        // Add cards to decks
        p1Cards.forEach(card => player1.deck.addCard(card));
        p2Cards.forEach(card => player2.deck.addCard(card));

        // Set up initial board state
        try {
            // Set Player 1's hand
            player1.setHand([p1Cards[1], p1Cards[1], p1Cards[2], p1Cards[3], p1Cards[4], p1Cards[5]]);

            // Add Pokemon to Player 1's bench
            const benchCards = [p1Cards[2], p1Cards[4]];
            benchCards.forEach((card, index) => {
                if (index < 5) {
                    const benchSlot = document.querySelectorAll('.bench .card.player.benched')[index];
                    if (benchSlot) {
                        benchSlot.style.backgroundImage = `url(${card.imgUrl})`;
                        benchSlot.classList.remove('empty');
                        player1.bench.push(card);
                    }
                }
            });

            // Set opponent's active Pokemon
            const oppActiveSlot = document.querySelector('.card.active.opp');
            if (oppActiveSlot && p2Cards[0]) {
                oppActiveSlot.style.backgroundImage = `url(${p2Cards[0].imgUrl})`;
                oppActiveSlot.classList.remove('empty');
                player2.activePokemon = p2Cards[0];
            }

            // Add opponent bench Pokemon
            const oppBenchCards = [p2Cards[1], p2Cards[2]];
            oppBenchCards.forEach((card, index) => {
                const oppBenchSlot = document.querySelectorAll('.bench .card.opp')[index];
                if (oppBenchSlot) {
                    oppBenchSlot.style.backgroundImage = `url(${card.imgUrl})`;
                    oppBenchSlot.classList.remove('empty');
                    player2.bench.push(card);
                }
            });

            // Set Player 1's active Pokemon (from hand)
            if (!player1.activePokemon) {
                const handCardEls = document.querySelectorAll('#PlayerHand .card');
                if (handCardEls.length > 0) {
                    handCardEls[0].click();
                }
            }

            // Start the game
            game.start();

            // Initialize drag and drop system using GUIHookUtils
            const container = document.getElementById('sixteenbynine');
            guiHook.initializeDragAndDrop(container, player1);

        } catch (error) {
            console.error('Error setting up board:', error);
        }

    </script>
</body>
<script src="BoardDynamicSizing.js"></script>

</html>