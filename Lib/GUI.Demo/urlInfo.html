<!DOCTYPE html>
<html>
<head>
    <title>Codespace URL Info</title>
</head>
<body>
    <h1>Codespace URL Information</h1>
    <div id="info"></div>
    
    <script>
        const info = document.getElementById('info');
        const hostname = window.location.hostname;
        const protocol = window.location.protocol;
        const port = window.location.port;
        
        info.innerHTML = `
            <p><strong>Current URL:</strong> ${window.location.href}</p>
            <p><strong>Hostname:</strong> ${hostname}</p>
            <p><strong>Protocol:</strong> ${protocol}</p>
            <p><strong>Port:</strong> ${port}</p>
            <br>
            <p><strong>Detected WebSocket URLs:</strong></p>
        `;
        
        let wsUrl;
        if (hostname.includes('.app.github.dev')) {
            // GitHub Codespace - use the forwarded port URL
            const baseUrl = hostname.replace('-3000.', '-8080.');
            wsUrl = `wss://${baseUrl}`;
            info.innerHTML += `<p>Codespace detected: ${wsUrl}</p>`;
        } else if (hostname === 'localhost' || hostname === '127.0.0.1') {
            // Local development
            wsUrl = 'ws://localhost:8080';
            info.innerHTML += `<p>Local development: ${wsUrl}</p>`;
        } else {
            // Generic case
            wsUrl = `ws://${hostname}:8080`;
            info.innerHTML += `<p>Generic: ${wsUrl}</p>`;
        }
        
        info.innerHTML += `<br><p><strong>Final WebSocket URL:</strong> ${wsUrl}</p>`;
        
        // Test if we can connect
        info.innerHTML += `<br><button onclick="testConnection()">Test WebSocket Connection</button>`;
        info.innerHTML += `<div id="test-result"></div>`;
        
        window.testConnection = function() {
            const result = document.getElementById('test-result');
            result.innerHTML = '<p>Testing connection...</p>';
            
            const ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                result.innerHTML = '<p style="color: green;">✅ WebSocket connection successful!</p>';
                ws.close();
            };
            
            ws.onerror = (error) => {
                result.innerHTML = '<p style="color: red;">❌ WebSocket connection failed</p>';
                console.error('WebSocket error:', error);
            };
            
            ws.onclose = () => {
                console.log('WebSocket connection closed');
            };
        };
    </script>
</body>
</html>