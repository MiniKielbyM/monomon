<!DOCTYPE html>
<html>

<head>
  <title>Home</title>
</head>

<body>
  <% if (isAuthenticated) { %>
    <h1>Welcome <%= userInfo.email %>
    </h1>
    <p>You are logged in.</p>
    <a href="/logout">Logout</a>

    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
    <script>
      // Only authenticated users can connect
      const socket = io({ transports: ['polling', 'websocket'] });

      socket.on('connect', () => {
        console.log('✅ Connected to server via Socket.IO');
      });

      socket.on('connect_error', (err) => {
        console.error('❌ Socket connection failed:', err.message);
      });

      socket.on('message', (data) => {
        console.log('📩 Received message:', data);
      });
    </script>
    <% } else { %>
      <h1>You are not logged in</h1>
      <a href="/login">Login</a>
      <% } %>
</body>

</html>