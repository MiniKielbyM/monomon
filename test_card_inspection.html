<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Inspection Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2e7d32;
            margin: 0;
            padding: 20px;
        }
        
        .card {
            width: 150px;
            height: 200px;
            border: 2px solid #000;
            border-radius: 10px;
            margin: 10px;
            cursor: pointer;
            background-size: cover;
            background-position: center;
            display: inline-block;
            transition: transform 0.2s;
        }
        
        .card:hover {
            transform: scale(1.05);
        }
        
        .test-container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
        }
        
        h1 {
            color: white;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Card Inspection Test - Click any card to inspect</h1>
    
    <div class="test-container">
        <h2>Test Cards (with actual card class instances)</h2>
        <div id="alakazam-card" class="card" style="background-image: url('https://images.pokemontcg.io/base1/1_hires.png');"></div>
        <div id="blastoise-card" class="card" style="background-image: url('https://images.pokemontcg.io/base1/2_hires.png');"></div>
        <div id="pikachu-card" class="card" style="background-image: url('https://images.pokemontcg.io/base4/87_hires.png');"></div>
    </div>

    <script type="module">
        import GUIHookUtils from './Lib/guiHookUtils.js';
        
        // Create GUI hook instance
        const guiHook = new GUIHookUtils(document.body);
        
        // Create test card data (simulating server data)
        const testCards = {
            'alakazam-card': {
                cardName: 'Alakazam',
                type: 'psychic',
                hp: 80,
                health: 60, // Some damage
                imgUrl: 'https://images.pokemontcg.io/base1/1_hires.png',
                statusConditions: ['confused']
            },
            'blastoise-card': {
                cardName: 'Blastoise',
                type: 'water',
                hp: 100,
                health: 100,
                imgUrl: 'https://images.pokemontcg.io/base1/2_hires.png'
            },
            'pikachu-card': {
                cardName: 'Pikachu',
                type: 'lightning',
                hp: 60,
                health: 60,
                imgUrl: 'https://images.pokemontcg.io/base4/87_hires.png'
            }
        };
        
        // Set up card data for each test card
        Object.keys(testCards).forEach(cardId => {
            const cardEl = document.getElementById(cardId);
            const serverCardData = testCards[cardId];
            
            // Convert server card data to card class instance
            const cardInstance = guiHook.createCardInstance(serverCardData);
            
            // Set both properties: cardData for compatibility and cardInstance for direct access
            cardEl.cardData = serverCardData;
            cardEl.cardInstance = cardInstance; // Direct pointer to card class
            
            console.log(`Set up ${cardId}:`, {
                serverData: serverCardData,
                cardInstance: cardInstance,
                hasAttacks: cardInstance?.attacks ? Object.keys(cardInstance.attacks) : 'none',
                hasAbilities: cardInstance?.abilities ? Object.keys(cardInstance.abilities) : 'none'
            });
            
            // Add click listener
            cardEl.addEventListener('click', () => {
                console.log('Clicked card:', cardId, {
                    cardData: cardEl.cardData,
                    cardInstance: cardEl.cardInstance
                });
                guiHook.showCardInspectionModal(cardEl, guiHook.getCardDataFromElement(cardEl));
            });
        });
        
        console.log('Card inspection test ready! Click any card to test.');
    </script>
</body>
</html>